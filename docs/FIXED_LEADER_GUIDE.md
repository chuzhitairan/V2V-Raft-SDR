# å›ºå®šé¢†å¯¼è€…å®éªŒæ“ä½œæŒ‡å—

æœ¬æ–‡æ¡£æè¿°åŸºäºå›ºå®šé¢†å¯¼è€…çš„ V2V-Raft ç¡¬ä»¶å®éªŒï¼Œè·³è¿‡é€‰ä¸¾è¿‡ç¨‹ï¼Œä¸“æ³¨äºå…±è¯†å†³ç­–ï¼ˆæ—¥å¿—å¤åˆ¶ï¼‰ã€‚

---

## ç›®å½•

1. [ç³»ç»Ÿæ¶æ„](#1-ç³»ç»Ÿæ¶æ„)
2. [ç¡¬ä»¶é…ç½®](#2-ç¡¬ä»¶é…ç½®)
3. [å¿«é€Ÿå¼€å§‹](#3-å¿«é€Ÿå¼€å§‹)
4. [åŒæœºéƒ¨ç½²](#4-åŒæœºéƒ¨ç½²)
5. [æ‰‹åŠ¨å¯åŠ¨æ­¥éª¤](#5-æ‰‹åŠ¨å¯åŠ¨æ­¥éª¤)
6. [å‘½ä»¤å‚æ•°è¯¦è§£](#6-å‘½ä»¤å‚æ•°è¯¦è§£)
7. [å®éªŒæ“ä½œ](#7-å®éªŒæ“ä½œ)
8. [è°ƒè¯•å·¥å…·](#8-è°ƒè¯•å·¥å…·)
9. [å¸¸è§é—®é¢˜](#9-å¸¸è§é—®é¢˜)

---

## 1. ç³»ç»Ÿæ¶æ„

### 1.1 å•æœºéƒ¨ç½²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”µè„‘ (6 å° SDR)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚   Node 1    â”‚     â”‚   Node 2    â”‚     â”‚   Node 3    â”‚      â”‚
â”‚   â”‚  [LEADER]   â”‚     â”‚ [Follower]  â”‚     â”‚ [Follower]  â”‚      â”‚
â”‚   â”‚   E200-1    â”‚     â”‚   E200-2    â”‚     â”‚   E200-3    â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚   Node 4    â”‚     â”‚   Node 5    â”‚     â”‚   Node 6    â”‚      â”‚
â”‚   â”‚ [Follower]  â”‚     â”‚ [Follower]  â”‚     â”‚ [Follower]  â”‚      â”‚
â”‚   â”‚   E200-4    â”‚     â”‚   U200-1    â”‚     â”‚   U200-2    â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 åŒæœºéƒ¨ç½²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ç”µè„‘ 1 (4x E200)    â”‚          â”‚     ç”µè„‘ 2 (2x U200)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Node 1 â”‚  â”‚Node 2 â”‚  â”‚          â”‚  â”‚Node 5 â”‚  â”‚Node 6 â”‚  â”‚
â”‚  â”‚LEADER â”‚  â”‚Follow â”‚  â”‚          â”‚  â”‚Follow â”‚  â”‚Follow â”‚  â”‚
â”‚  â”‚E200-1 â”‚  â”‚E200-2 â”‚  â”‚          â”‚  â”‚U200-1 â”‚  â”‚U200-2 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚    æ— çº¿   â”‚                        â”‚
â”‚  â”‚Node 3 â”‚  â”‚Node 4 â”‚  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
â”‚  â”‚Follow â”‚  â”‚Follow â”‚  â”‚  802.11  â”‚                        â”‚
â”‚  â”‚E200-3 â”‚  â”‚E200-4 â”‚  â”‚          â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚          â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      run_pc1_e200.sh                     run_pc2_u200.sh
```

### 1.3 ä¸æ ‡å‡† Raft çš„åŒºåˆ«

| ç‰¹æ€§ | æ ‡å‡† Raft | å›ºå®šé¢†å¯¼è€…ç‰ˆ |
|------|-----------|-------------|
| é€‰ä¸¾ | è¶…æ—¶è§¦å‘é€‰ä¸¾ | **æ— é€‰ä¸¾ï¼Œå¯åŠ¨æ—¶æŒ‡å®š** |
| Term | åŠ¨æ€å˜åŒ– | **å›ºå®šä¸º 1** |
| Leader ç¡®å®š | æŠ•ç¥¨äº§ç”Ÿ | **å¯åŠ¨å‚æ•°æŒ‡å®š** |
| æ—¥å¿—å¤åˆ¶ | âœ… å®Œæ•´å®ç° | âœ… å®Œæ•´å®ç° |
| å¤šæ•°æ´¾æäº¤ | âœ… å®Œæ•´å®ç° | âœ… å®Œæ•´å®ç° |
| SNR è¿‡æ»¤ | âœ… æ”¯æŒ | âœ… æ”¯æŒ |

---

## 2. ç¡¬ä»¶é…ç½®

### 2.1 SDR è®¾å¤‡

| èŠ‚ç‚¹ | è®¾å¤‡ç±»å‹ | è¿æ¥å‚æ•° | ç«¯å£é…ç½® | éƒ¨ç½²ä½ç½® |
|------|----------|----------|----------|----------|
| Node 1 (Leader) | ANTSDR E200 | `addr=192.168.1.10` | TX:10001, RX:20001, Ctrl:9001 | ç”µè„‘ 1 |
| Node 2 | ANTSDR E200 | `addr=192.168.1.11` | TX:10002, RX:20002, Ctrl:9002 | ç”µè„‘ 1 |
| Node 3 | ANTSDR E200 | `addr=192.168.1.12` | TX:10003, RX:20003, Ctrl:9003 | ç”µè„‘ 1 |
| Node 4 | ANTSDR E200 | `addr=192.168.1.13` | TX:10004, RX:20004, Ctrl:9004 | ç”µè„‘ 1 |
| Node 5 | USRP U200 | `serial=U200100` | TX:10005, RX:20005, Ctrl:9005 | ç”µè„‘ 2 |
| Node 6 | USRP U200 | `serial=U200101` | TX:10006, RX:20006, Ctrl:9006 | ç”µè„‘ 2 |

### 2.2 ç½‘ç»œæ£€æŸ¥

**ç”µè„‘ 1 (E200):**
```bash
ping -c 1 192.168.1.10
ping -c 1 192.168.1.11
ping -c 1 192.168.1.12
ping -c 1 192.168.1.13
```

**ç”µè„‘ 2 (U200):**
```bash
uhd_find_devices --args="type=usrp2"
```

---

## 3. å¿«é€Ÿå¼€å§‹

### 3.1 ä¸€é”®å¯åŠ¨ 6 èŠ‚ç‚¹

```bash
cd ~/V2V-Raft-SDR
./scripts/run_fixed_leader.sh
```

è„šæœ¬ä¼šï¼š
1. æ¸…ç†æ—§è¿›ç¨‹
2. **ä¸²è¡Œå¯åŠ¨** 6 ä¸ª PHY å±‚ï¼ˆé€ä¸ªç­‰å¾…å°±ç»ªï¼‰
3. å¯åŠ¨ 6 ä¸ªåº”ç”¨å±‚çª—å£ï¼ˆ3x2 æ’åˆ—ï¼‰
4. Node 1 ä¸º Leaderï¼ˆé»„è‰²çª—å£ï¼‰ï¼Œå…¶ä½™ä¸º Followerï¼ˆç™½è‰²çª—å£ï¼‰

### 3.2 åŸºæœ¬æ“ä½œ

- **å‘èµ·å…±è¯†**: åœ¨ Leader çª—å£æŒ‰å›è½¦ï¼Œå‘é€"å‘å·¦å˜é“"
- **è‡ªå®šä¹‰å‘½ä»¤**: è¾“å…¥å‘½ä»¤åæŒ‰å›è½¦
- **åœæ­¢å®éªŒ**: æŒ‰ `Ctrl+C`

---

## 4. åŒæœºéƒ¨ç½²

å½“ E200 å’Œ U200 åˆ†åˆ«è¿æ¥åˆ°ä¸åŒç”µè„‘æ—¶ä½¿ç”¨æ­¤æ–¹æ¡ˆã€‚

### 4.1 ç”µè„‘åˆ†é…

| ç”µè„‘ | SDR è®¾å¤‡ | èŠ‚ç‚¹ | è„šæœ¬ |
|------|----------|------|------|
| ç”µè„‘ 1 | 4x E200 (ç½‘å£) | Node 1-4 | `run_pc1_e200.sh` |
| ç”µè„‘ 2 | 2x U200 (USB) | Node 5-6 | `run_pc2_u200.sh` |

### 4.2 å¯åŠ¨é¡ºåº

**é‡è¦**: å…ˆå¯åŠ¨ç”µè„‘ 1ï¼ˆåŒ…å« Leaderï¼‰ï¼Œå†å¯åŠ¨ç”µè„‘ 2ã€‚

**ç¬¬ä¸€æ­¥: ç”µè„‘ 1 (E200)**
```bash
cd ~/V2V-Raft-SDR
./scripts/run_pc1_e200.sh
```

è„šæœ¬ä¼šï¼š
- å¯åŠ¨ 4 ä¸ª PHY å±‚ï¼ˆä¸²è¡Œå¯åŠ¨ï¼‰
- å¯åŠ¨ 4 ä¸ªåº”ç”¨å±‚çª—å£ï¼ˆ2x2 æ’åˆ—ï¼‰
- Node 1 ä¸º Leaderï¼ˆé»„è‰²çª—å£ï¼‰ï¼ŒNode 2-4 ä¸º Followerï¼ˆç™½è‰²çª—å£ï¼‰

ç­‰å¾…çœ‹åˆ° 4 ä¸ªçª—å£éƒ½æ˜¾ç¤º `ç­‰å¾…å‘½ä»¤è¾“å…¥` å...

**ç¬¬äºŒæ­¥: ç”µè„‘ 2 (U200)**
```bash
cd ~/V2V-Raft-SDR
./scripts/run_pc2_u200.sh
```

è„šæœ¬ä¼šï¼š
- å¯åŠ¨ 2 ä¸ª PHY å±‚ï¼ˆä¸²è¡Œå¯åŠ¨ï¼ŒU200 åˆå§‹åŒ–è¾ƒæ…¢ï¼‰
- å¯åŠ¨ 2 ä¸ªåº”ç”¨å±‚çª—å£ï¼ˆæ°´å¹³æ’åˆ—ï¼‰
- Node 5-6 ä¸º Followerï¼ˆé’è‰²çª—å£ï¼‰

### 4.3 çª—å£å¸ƒå±€

**ç”µè„‘ 1 (2x2 å¸ƒå±€):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Node 1      â”‚   Node 2      â”‚
â”‚  [LEADER]     â”‚  [Follower]   â”‚
â”‚   é»„è‰²        â”‚   ç™½è‰²        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Node 3      â”‚   Node 4      â”‚
â”‚  [Follower]   â”‚  [Follower]   â”‚
â”‚   ç™½è‰²        â”‚   ç™½è‰²        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç”µè„‘ 2 (1x2 å¸ƒå±€):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Node 5      â”‚   Node 6      â”‚
â”‚  [Follower]   â”‚  [Follower]   â”‚
â”‚   é’è‰²        â”‚   é’è‰²        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 é€šä¿¡éªŒè¯

ä¸¤å°ç”µè„‘å¯åŠ¨åï¼Œæ£€æŸ¥ Leader (Node 1) çª—å£æ˜¯å¦æ˜¾ç¤ºï¼š
```
å½“å‰é‚»å±…: [2, 3, 4, 5, 6]
```

å¦‚æœç¼ºå°‘ Node 5, 6ï¼Œè¯´æ˜æ— çº¿é“¾è·¯æœªé€šï¼Œæ£€æŸ¥ï¼š
- SDR å¤©çº¿æ˜¯å¦æ­£ç¡®è¿æ¥
- é¢‘ç‡å’Œå¢ç›Šè®¾ç½®æ˜¯å¦ä¸€è‡´
- ä¸¤å°ç”µè„‘ SDR ä¹‹é—´æ˜¯å¦æœ‰éšœç¢ç‰©

### 4.5 åœæ­¢å®éªŒ

**ä¸¤å°ç”µè„‘åˆ†åˆ«æŒ‰ Ctrl+C**ï¼š
```bash
# ç”µè„‘ 1
Ctrl+C  # åœæ­¢ run_pc1_e200.sh

# ç”µè„‘ 2  
Ctrl+C  # åœæ­¢ run_pc2_u200.sh
```

---

## 5. æ‰‹åŠ¨å¯åŠ¨æ­¥éª¤

é€‚ç”¨äºéœ€è¦å•ç‹¬è°ƒè¯•æŸä¸ªèŠ‚ç‚¹çš„æƒ…å†µã€‚

### 4.1 å¯åŠ¨ PHY å±‚

æ¯ä¸ªèŠ‚ç‚¹éœ€è¦å…ˆå¯åŠ¨ PHY å±‚ï¼š

```bash
# Node 1 (E200-1)
python3 scripts/core/v2v_hw_phy.py \
    --sdr-args "addr=192.168.1.10" \
    --tx-gain 0.7 --rx-gain 0.7 \
    --udp-recv-port 10001 \
    --udp-send-port 20001 \
    --ctrl-port 9001 \
    --no-gui

# Node 2 (E200-2)
python3 scripts/core/v2v_hw_phy.py \
    --sdr-args "addr=192.168.1.11" \
    --tx-gain 0.7 --rx-gain 0.7 \
    --udp-recv-port 10002 \
    --udp-send-port 20002 \
    --ctrl-port 9002 \
    --no-gui

# Node 3 (E200-3)
python3 scripts/core/v2v_hw_phy.py \
    --sdr-args "addr=192.168.1.12" \
    --tx-gain 0.7 --rx-gain 0.7 \
    --udp-recv-port 10003 \
    --udp-send-port 20003 \
    --ctrl-port 9003 \
    --no-gui

# Node 4 (E200-4)
python3 scripts/core/v2v_hw_phy.py \
    --sdr-args "addr=192.168.1.13" \
    --tx-gain 0.7 --rx-gain 0.7 \
    --udp-recv-port 10004 \
    --udp-send-port 20004 \
    --ctrl-port 9004 \
    --no-gui

# Node 5 (U200-1)
python3 scripts/core/v2v_hw_phy.py \
    --sdr-args "serial=U200100" \
    --tx-gain 0.7 --rx-gain 0.7 \
    --udp-recv-port 10005 \
    --udp-send-port 20005 \
    --ctrl-port 9005 \
    --no-gui

# Node 6 (U200-2)
python3 scripts/core/v2v_hw_phy.py \
    --sdr-args "serial=U200101" \
    --tx-gain 0.7 --rx-gain 0.7 \
    --udp-recv-port 10006 \
    --udp-send-port 20006 \
    --ctrl-port 9006 \
    --no-gui
```

### 4.2 å¯åŠ¨åº”ç”¨å±‚

ç­‰ PHY å±‚å°±ç»ªåï¼Œå¯åŠ¨åº”ç”¨å±‚ï¼š

```bash
# Node 1 - Leader
python3 scripts/app/raft_fixed_leader.py \
    --id 1 --role leader \
    --total 6 \
    --tx 10001 --rx 20001 \
    --leader-id 1

# Node 2 - Follower
python3 scripts/app/raft_fixed_leader.py \
    --id 2 --role follower \
    --total 6 \
    --tx 10002 --rx 20002 \
    --leader-id 1

# Node 3 - Follower
python3 scripts/app/raft_fixed_leader.py \
    --id 3 --role follower \
    --total 6 \
    --tx 10003 --rx 20003 \
    --leader-id 1

# Node 4 - Follower
python3 scripts/app/raft_fixed_leader.py \
    --id 4 --role follower \
    --total 6 \
    --tx 10004 --rx 20004 \
    --leader-id 1

# Node 5 - Follower
python3 scripts/app/raft_fixed_leader.py \
    --id 5 --role follower \
    --total 6 \
    --tx 10005 --rx 20005 \
    --leader-id 1

# Node 6 - Follower
python3 scripts/app/raft_fixed_leader.py \
    --id 6 --role follower \
    --total 6 \
    --tx 10006 --rx 20006 \
    --leader-id 1
```

### 4.3 å°‘èŠ‚ç‚¹æµ‹è¯•

åªæµ‹è¯• 2 ä¸ªèŠ‚ç‚¹ï¼š

```bash
# ç»ˆç«¯ 1 - PHY 1
python3 scripts/core/v2v_hw_phy.py \
    --sdr-args "addr=192.168.1.10" \
    --tx-gain 0.7 --rx-gain 0.7 \
    --udp-recv-port 10001 --udp-send-port 20001 \
    --ctrl-port 9001 --no-gui

# ç»ˆç«¯ 2 - PHY 2
python3 scripts/core/v2v_hw_phy.py \
    --sdr-args "addr=192.168.1.11" \
    --tx-gain 0.7 --rx-gain 0.7 \
    --udp-recv-port 10002 --udp-send-port 20002 \
    --ctrl-port 9002 --no-gui

# ç»ˆç«¯ 3 - Leader (ç­‰ PHY å°±ç»ªå)
python3 scripts/app/raft_fixed_leader.py \
    --id 1 --role leader --total 2 \
    --tx 10001 --rx 20001

# ç»ˆç«¯ 4 - Follower
python3 scripts/app/raft_fixed_leader.py \
    --id 2 --role follower --total 2 \
    --tx 10002 --rx 20002 --leader-id 1
```

---

## 6. å‘½ä»¤å‚æ•°è¯¦è§£

### 5.1 PHY å±‚å‚æ•° (v2v_hw_phy.py)

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `--sdr-args` | SDR è®¾å¤‡å‚æ•° | `addr=192.168.1.10` æˆ– `serial=U200100` |
| `--tx-gain` | å‘å°„å¢ç›Š (0.0-1.0) | `0.7` |
| `--rx-gain` | æ¥æ”¶å¢ç›Š (0.0-1.0) | `0.7` |
| `--udp-recv-port` | æ¥æ”¶åº”ç”¨å±‚æ•°æ®çš„ç«¯å£ | `10001` |
| `--udp-send-port` | å‘é€æ•°æ®åˆ°åº”ç”¨å±‚çš„ç«¯å£ | `20001` |
| `--ctrl-port` | æ§åˆ¶ç«¯å£ï¼ˆè¿è¡Œæ—¶è°ƒå‚ï¼‰ | `9001` |
| `--no-gui` | æ— ç•Œé¢æ¨¡å¼ | (æ— å‚æ•°å€¼) |

### 5.2 åº”ç”¨å±‚å‚æ•° (raft_fixed_leader.py)

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `--id` | èŠ‚ç‚¹ ID | `1` |
| `--role` | è§’è‰²: `leader` æˆ– `follower` | `leader` |
| `--total` | æ€»èŠ‚ç‚¹æ•° | `6` |
| `--tx` | å‘é€ç«¯å£ (å¯¹åº” PHY çš„ udp-recv-port) | `10001` |
| `--rx` | æ¥æ”¶ç«¯å£ (å¯¹åº” PHY çš„ udp-send-port) | `20001` |
| `--leader-id` | Leader èŠ‚ç‚¹ ID | `1` |
| `--snr-threshold` | SNR è¿‡æ»¤é˜ˆå€¼ (dB) | `5.0` |

### 5.3 ç«¯å£å…³ç³»å›¾

```
App å±‚          PHY å±‚          æ— çº¿ä¿¡é“
  â”‚               â”‚               â”‚
  â”‚â”€â”€TX:10001â”€â”€â”€â”€â–ºâ”‚               â”‚
  â”‚               â”‚â”€â”€â”€â”€ WiFi â”€â”€â”€â”€â–ºâ”‚
  â”‚â—„â”€â”€RX:20001â”€â”€â”€â”€â”‚               â”‚
  â”‚               â”‚â—„â”€â”€â”€â”€ WiFi â”€â”€â”€â”€â”‚
  â”‚               â”‚               â”‚
  â”‚  Ctrl:9001â”€â”€â”€â–ºâ”‚ (è¿è¡Œæ—¶è°ƒå‚)  â”‚
```

---

## 7. å®éªŒæ“ä½œ

### 6.1 å‘èµ·å…±è¯†è¯·æ±‚

åœ¨ **Leader çª—å£**:

```
# ç›´æ¥æŒ‰å›è½¦ -> å‘é€é»˜è®¤å‘½ä»¤ "å‘å·¦å˜é“"
<Enter>

# æˆ–è¾“å…¥è‡ªå®šä¹‰å‘½ä»¤
ç´§æ€¥åˆ¹è½¦<Enter>
å˜é“åˆ°å³ä¾§è½¦é“<Enter>
```

### 6.2 è§‚å¯Ÿè¾“å‡º

**Leader è¾“å‡º**:
```
ğŸ“ [æäº¤] æ—¥å¿— #1: å‘å·¦å˜é“
ğŸ“Š [çŠ¶æ€] æ—¥å¿—:1 æäº¤:0 æ‰§è¡Œ:0 | é‚»å±…: N2:15.4dB, N3:16.9dB
   å¿ƒè·³: 50, å¤åˆ¶: 1 | match: N2:0, N3:0, N4:0
âœ¨ [å…±è¯†] æ‰§è¡Œå‘½ä»¤ #1: å‘å·¦å˜é“
ğŸ“Š [çŠ¶æ€] æ—¥å¿—:1 æäº¤:1 æ‰§è¡Œ:1 | é‚»å±…: N2:15.4dB, N3:16.9dB
   å¿ƒè·³: 55, å¤åˆ¶: 1 | match: N2:1, N3:1, N4:1
```

**Follower è¾“å‡º**:
```
ğŸ“¥ [å¤åˆ¶] æ”¶åˆ° 1 æ¡æ–°æ—¥å¿—ï¼Œå½“å‰é•¿åº¦: 1
âœ¨ [å…±è¯†] æ‰§è¡Œå‘½ä»¤ #1: å‘å·¦å˜é“
ğŸ“Š [çŠ¶æ€] æ—¥å¿—:1 æäº¤:1 æ‰§è¡Œ:1 | é‚»å±…: N1:14.2dB
   å¿ƒè·³æ¥æ”¶: 55, è¿‡æ»¤: 0
```

### 6.3 ç†è§£çŠ¶æ€è¾“å‡º

```
ğŸ“Š [çŠ¶æ€] æ—¥å¿—:3 æäº¤:2 æ‰§è¡Œ:2 | é‚»å±…: N2:15.4dB, N3:16.9dB
           â”‚      â”‚      â”‚              â”‚
           â”‚      â”‚      â”‚              â””â”€ é‚»å±… SNR
           â”‚      â”‚      â””â”€ å·²æ‰§è¡Œçš„æ—¥å¿—æ•°
           â”‚      â””â”€ å·²æäº¤çš„æ—¥å¿—æ•° (å¤šæ•°æ´¾ç¡®è®¤)
           â””â”€ æœ¬åœ°æ—¥å¿—æ€»æ•°

   å¿ƒè·³: 100, å¤åˆ¶: 5 | match: N2:3, N3:3, N4:2
                              â”‚
                              â””â”€ æ¯ä¸ª Follower å·²ç¡®è®¤çš„æ—¥å¿—ç´¢å¼•
```

### 6.4 SNR è¿‡æ»¤å®éªŒ

æµ‹è¯•ä¿¡å·è´¨é‡å¯¹å…±è¯†çš„å½±å“ï¼š

```bash
# å¯åŠ¨æ—¶è®¾ç½®è¾ƒé«˜çš„ SNR é˜ˆå€¼
python3 scripts/app/raft_fixed_leader.py \
    --id 1 --role leader --total 6 \
    --tx 10001 --rx 20001 \
    --snr-threshold 10.0   # åªæ¥å— SNR > 10dB çš„æ¶ˆæ¯
```

ä¿¡å·å·®çš„èŠ‚ç‚¹ä¼šè¢«è‡ªåŠ¨æ’é™¤ï¼Œè¾“å‡ºæ˜¾ç¤ºè¿‡æ»¤è®¡æ•°ï¼š
```
ğŸ“Š [çŠ¶æ€] ... | å¿ƒè·³æ¥æ”¶: 100, è¿‡æ»¤: 23
                                    â””â”€ 23 æ¡æ¶ˆæ¯å›  SNR è¿‡ä½è¢«è¿‡æ»¤
```

---

## 8. è°ƒè¯•å·¥å…·

### 7.1 è¿è¡Œæ—¶è°ƒæ•´å¢ç›Š

PHY è¿è¡Œä¸­å¯é€šè¿‡æ§åˆ¶ç«¯å£è°ƒæ•´å¢ç›Šï¼š

```bash
# è®¾ç½® TX å¢ç›Š
echo '{"cmd":"set_tx_gain","value":0.8}' | nc -u -w1 127.0.0.1 9001

# è®¾ç½® RX å¢ç›Š
echo '{"cmd":"set_rx_gain","value":0.8}' | nc -u -w1 127.0.0.1 9001

# æ£€æŸ¥ PHY æ˜¯å¦å“åº”
echo '{"cmd":"ping"}' | nc -u -w1 127.0.0.1 9001
# æœŸæœ›è¿”å›: {"msg":"pong"}
```

### 7.2 è¿é€šæ€§æµ‹è¯•

æµ‹è¯•å„èŠ‚ç‚¹åˆ°æŸèŠ‚ç‚¹çš„è¿é€šæ€§ï¼š

```bash
# Node 1 æ¥æ”¶ï¼Œå…¶ä»–èŠ‚ç‚¹å‘é€
python3 scripts/app/connectivity_test.py --receiver 1

# åªæµ‹ E200 èŠ‚ç‚¹
python3 scripts/app/connectivity_test.py --receiver 1 --senders 2,3,4

# æŒ‡å®šå¢ç›Šå’Œæ—¶é•¿
python3 scripts/app/connectivity_test.py \
    --receiver 1 \
    --tx-gain 0.8 --rx-gain 0.8 \
    --duration 30
```

### 7.3 å¤šèŠ‚ç‚¹å¢ç›Šè°ƒä¼˜

æ‰«æå¢ç›Šç»„åˆï¼Œæ‰¾æœ€ä½³é…ç½®ï¼š

```bash
# æµ‹è¯•å…¨éƒ¨ 6 èŠ‚ç‚¹
python3 scripts/app/multi_gain_tuner.py

# åªæµ‹ 4 ä¸ª E200
python3 scripts/app/multi_gain_tuner.py --nodes 1,2,3,4

# è‡ªå®šä¹‰å¢ç›ŠèŒƒå›´
python3 scripts/app/multi_gain_tuner.py \
    --tx-range 0.6 0.8 0.05 \
    --rx-range 0.6 0.8 0.05 \
    --duration 10
```

### 7.4 è¿›ç¨‹ç®¡ç†

```bash
# æŸ¥çœ‹è¿è¡Œä¸­çš„è¿›ç¨‹
ps aux | grep -E "v2v_hw_phy|raft_fixed"

# åœæ­¢æ‰€æœ‰ç›¸å…³è¿›ç¨‹
pkill -f "v2v_hw_phy.py"
pkill -f "raft_fixed_leader.py"

# æ£€æŸ¥ç«¯å£å ç”¨
ss -tuln | grep -E "1000[1-6]|2000[1-6]|900[1-6]"
```

---

## 9. å¸¸è§é—®é¢˜

### Q1: PHY å¯åŠ¨å¤±è´¥

**ç°è±¡**: `âŒ æ§åˆ¶ç«¯å£æ— å“åº”`

**è§£å†³**:
```bash
# 1. æ£€æŸ¥è®¾å¤‡è¿æ¥
ping 192.168.1.10          # E200
uhd_find_devices           # U200

# 2. æ¸…ç†æ®‹ç•™è¿›ç¨‹
pkill -f v2v_hw_phy.py

# 3. ç­‰å¾…å‡ ç§’åé‡è¯•
sleep 5
```

### Q2: å…±è¯†å»¶è¿Ÿé«˜

**ç°è±¡**: æäº¤å¤šæ¡æ—¥å¿—åæ‰æ‰¹é‡è¾¾æˆå…±è¯†

**åŸå› **: æ— çº¿ä¸¢åŒ…å¯¼è‡´ `APPEND_RESPONSE` å»¶è¿Ÿ

**è§£å†³**:
- æé«˜å¢ç›Š: `--tx-gain 0.8 --rx-gain 0.8`
- å‡å°å¤©çº¿è·ç¦»
- æ£€æŸ¥æ˜¯å¦æœ‰å¹²æ‰°æº

### Q3: Leader çœ‹ä¸åˆ° Follower

**ç°è±¡**: Leader çŠ¶æ€æ˜¾ç¤º `é‚»å±…: æ— `

**è§£å†³**:
```bash
# 1. æ£€æŸ¥ Follower æ˜¯å¦æ­£å¸¸å¯åŠ¨
# 2. æ£€æŸ¥ SNR é˜ˆå€¼æ˜¯å¦è¿‡é«˜
python3 scripts/app/raft_fixed_leader.py ... --snr-threshold 0
```

### Q4: çª—å£æ’åˆ—ä¸æ­£ç¡®

**ç°è±¡**: xterm çª—å£å¤§å°æˆ–ä½ç½®ä¸å¯¹

**è§£å†³**:
```bash
# æ£€æŸ¥å±å¹•åˆ†è¾¨ç‡
xdpyinfo | grep dimensions

# æ‰‹åŠ¨è°ƒæ•´è„šæœ¬ä¸­çš„å‚æ•°
vim scripts/run_fixed_leader.sh
# ä¿®æ”¹ COLS, ROWS, WIN_COLS, WIN_ROWS
```

---

## é™„å½•: æ–‡ä»¶ç»“æ„

```
V2V-Raft-SDR/
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â””â”€â”€ v2v_hw_phy.py          # PHY å±‚ (GNU Radio)
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ raft_fixed_leader.py   # å›ºå®šé¢†å¯¼è€… Raft èŠ‚ç‚¹
â”‚   â”‚   â”œâ”€â”€ raft_node.py           # æ ‡å‡† Raft èŠ‚ç‚¹
â”‚   â”‚   â”œâ”€â”€ connectivity_test.py   # è¿é€šæ€§æµ‹è¯•å·¥å…·
â”‚   â”‚   â””â”€â”€ multi_gain_tuner.py    # å¤šèŠ‚ç‚¹å¢ç›Šè°ƒä¼˜
â”‚   â”œâ”€â”€ run_fixed_leader.sh        # ä¸€é”®å¯åŠ¨ (å•æœº 6 èŠ‚ç‚¹)
â”‚   â”œâ”€â”€ run_pc1_e200.sh            # ç”µè„‘ 1 å¯åŠ¨ (4x E200)
â”‚   â””â”€â”€ run_pc2_u200.sh            # ç”µè„‘ 2 å¯åŠ¨ (2x U200)
â””â”€â”€ docs/
    â””â”€â”€ FIXED_LEADER_GUIDE.md      # æœ¬æ–‡æ¡£
```

---

**æœ€åæ›´æ–°**: 2025-01-20
