# SNR-é›†ç¾¤è§„æ¨¡å…³ç³»å®éªŒè¯´æ˜æ–‡æ¡£

## 1. å®éªŒæ¦‚è¿°

### 1.1 å®éªŒç›®çš„

ç ”ç©¶è½¦è”ç½‘ (V2V) ç¯å¢ƒä¸­ï¼Œ**ä¿¡å™ªæ¯” (SNR)** ä¸ **Raft å…±è¯†é›†ç¾¤è§„æ¨¡**ã€**ä¸¢åŒ…ç‡** ä¹‹é—´çš„å…³ç³»ã€‚

æ ¸å¿ƒé—®é¢˜ï¼š
1. **å½“ SNR é™ä½æ—¶ï¼Œèƒ½å¤Ÿç¨³å®šä¿æŒåœ¨ Raft é›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ•°é‡ä¼šå¦‚ä½•å˜åŒ–ï¼Ÿ**
2. **SNR ä¸ä¸¢åŒ…ç‡ä¹‹é—´æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ**

### 1.2 å®éªŒåŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å®éªŒåŸç†å›¾                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Leader (Node 1)              Follower (Node 2, 3, ...)       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚   â”‚ 1. å¹¿æ’­å¿ƒè·³   â”‚ â”€â”€APPENDâ”€â”€> â”‚ æ”¶åˆ°å¿ƒè·³     â”‚                â”‚
â”‚   â”‚ 2. è®°å½• SNR   â”‚ <â”€RESPONSEâ”€ â”‚ å‘é€å“åº”     â”‚                â”‚
â”‚   â”‚ 3. å¹¿æ’­SNRæŠ¥å‘Šâ”‚ â”€SNR_REPORTâ”€>â”‚ è°ƒæ•´TXå¢ç›Š   â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚          â”‚                            â”‚                        â”‚
â”‚          â”‚                            â”‚                        â”‚
â”‚          â–¼                            â–¼                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚   â”‚ é™ä½ç›®æ ‡ SNR  â”‚             â”‚ é™ä½å‘å°„åŠŸç‡  â”‚                â”‚
â”‚   â”‚ (20â†’18â†’16...) â”‚             â”‚ (å¢ç›Šä¸‹è°ƒ)    â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚          â”‚                            â”‚                        â”‚
â”‚          â–¼                            â–¼                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚  SNR é™ä½ â†’ ä¸¢åŒ…ç‡ä¸Šå‡ â†’ èŠ‚ç‚¹è¶…æ—¶ â†’ é›†ç¾¤ç¼©å°  â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®æœºåˆ¶ï¼š**

1. **SNR é—­ç¯æ§åˆ¶**ï¼šLeader è§‚æµ‹å„ Follower çš„ä¿¡å· SNRï¼Œé€šè¿‡ `SNR_REPORT` æ¶ˆæ¯å‘ŠçŸ¥ Follower
2. **å¢ç›Šè‡ªåŠ¨è°ƒæ•´**ï¼šFollower æ ¹æ®ç›®æ ‡ SNR è‡ªåŠ¨è°ƒæ•´ TX å¢ç›Šï¼Œä½¿å®é™… SNR é€¼è¿‘ç›®æ ‡å€¼
3. **åŠ¨æ€ç›®æ ‡ SNR**ï¼šå®éªŒè¿‡ç¨‹ä¸­ï¼ŒLeader é€æ­¥é™ä½ç›®æ ‡ SNRï¼ŒFollower è·Ÿéšè°ƒæ•´
4. **é›†ç¾¤è§„æ¨¡æµ‹é‡**ï¼šLeader ç»Ÿè®¡åœ¨ `cluster_timeout` æ—¶é—´å†…æœ‰å“åº”çš„èŠ‚ç‚¹æ•°é‡

### 1.3 å®éªŒå‡è®¾

- ä½ SNR â†’ é«˜è¯¯ç ç‡ â†’ æ¶ˆæ¯ä¸¢å¤± â†’ èŠ‚ç‚¹è¶…æ—¶ â†’ è¢«åˆ¤å®šä¸ºç¦»çº¿
- å­˜åœ¨ä¸´ç•Œ SNRï¼Œä½äºæ­¤å€¼æ—¶é›†ç¾¤å°†æ— æ³•ç»´æŒ

---

## 2. ç¡¬ä»¶é…ç½®

### 2.1 è®¾å¤‡æ¸…å•

| è®¾å¤‡ | æ•°é‡ | ä½ç½® | ç”¨é€” |
|------|------|------|------|
| ANTSDR E200 | 4 å° | PC1 | Node 1-4 |
| USRP U200 | 2 å° | PC2 | Node 5-6 |

### 2.2 ç½‘ç»œé…ç½®

```
E200 IP åœ°å€:
  Node 1: 192.168.1.10 (Leader)
  Node 2: 192.168.1.11
  Node 3: 192.168.1.12
  Node 4: 192.168.1.13

U200: ä½¿ç”¨ USB è¿æ¥
  Node 5: serial=... (ç¬¬ä¸€å°)
  Node 6: serial=... (ç¬¬äºŒå°)
```

### 2.3 ç«¯å£åˆ†é…

| èŠ‚ç‚¹ | TX ç«¯å£ | RX ç«¯å£ | Ctrl ç«¯å£ |
|------|---------|---------|-----------|
| Node 1 | 10001 | 20001 | 9001 |
| Node 2 | 10002 | 20002 | 9002 |
| Node 3 | 10003 | 20003 | 9003 |
| Node 4 | 10004 | 20004 | 9004 |
| Node 5 | 10005 | 20005 | 9005 |
| Node 6 | 10006 | 20006 | 9006 |

---

## 3. è½¯ä»¶æ¶æ„

### 3.1 æ–‡ä»¶ç»“æ„

```
scripts/
â”œâ”€â”€ run_snr_experiment_3node.sh     # 3èŠ‚ç‚¹æµ‹è¯•è„šæœ¬
â”œâ”€â”€ run_snr_experiment.sh           # 4èŠ‚ç‚¹(E200)å®éªŒè„šæœ¬
â”œâ”€â”€ run_snr_experiment_pc2.sh       # PC2(U200)å®éªŒè„šæœ¬ (å¾…åˆ›å»º)
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ raft_leader_snr_experiment.py    # å®éªŒç‰ˆ Leader
â”‚   â””â”€â”€ raft_follower_snr_experiment.py  # å®éªŒç‰ˆ Follower
â””â”€â”€ core/
    â””â”€â”€ v2v_hw_phy.py               # PHY å±‚ (GNU Radio)
```

### 3.2 æ¶ˆæ¯ç±»å‹

```python
@dataclass
class Message:
    type: str           # "APPEND", "APPEND_RESPONSE", "SNR_REPORT"
    term: int           # Raft ä»»æœŸ
    sender_id: int      # å‘é€è€… ID
    snr_report: Dict[int, float]  # SNR æŠ¥å‘Š {node_id: snr}
    target_snr: float   # ç›®æ ‡ SNR (åŠ¨æ€è°ƒæ•´)
    # ... å…¶ä»– Raft å­—æ®µ
```

### 3.3 æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®æµå‘                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  App Layer (Python)        PHY Layer (GNU Radio)    SDR        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Leader    â”‚â”€â”€TX:10001â†’â”‚             â”‚         â”‚     â”‚    â”‚
â”‚  â”‚   Node 1    â”‚â†RX:20001â”€â”€â”‚  v2v_hw_phy â”‚â†â”€â”€â”€â”€â”€â”€â”€â†’â”‚E200 â”‚    â”‚
â”‚  â”‚             â”‚  Ctrl:9001â”‚             â”‚         â”‚     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”˜    â”‚
â”‚        â”‚                          â–²                            â”‚
â”‚        â”‚ (UDP)                    â”‚ (å¢ç›Šæ§åˆ¶)                  â”‚
â”‚        â–¼                          â”‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Follower   â”‚â”€â”€TX:10002â†’â”‚             â”‚         â”‚     â”‚    â”‚
â”‚  â”‚   Node 2    â”‚â†RX:20002â”€â”€â”‚  v2v_hw_phy â”‚â†â”€â”€â”€â”€â”€â”€â”€â†’â”‚E200 â”‚    â”‚
â”‚  â”‚             â”‚  Ctrl:9002â”‚             â”‚         â”‚     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. å®éªŒå‚æ•°

### 4.1 é»˜è®¤å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `start_snr` | 20.0 dB | èµ·å§‹ç›®æ ‡ SNR |
| `snr_step` | 2.0 dB | SNR é€’å‡æ­¥é•¿ |
| `min_snr` | 0.0 dB | æœ€å° SNR (åœæ­¢æ¡ä»¶) |
| `measurements_per_snr` | 100 | æ¯ä¸ª SNR æµ‹é‡æ¬¡æ•° |
| `measurement_interval` | 0.5 s | æµ‹é‡é—´éš” |
| `stabilize_time` | 30.0 s | æœ€å¤§ç¨³å®šç­‰å¾…æ—¶é—´ |
| `cluster_timeout` | 2.0 s | èŠ‚ç‚¹åœ¨çº¿åˆ¤æ–­è¶…æ—¶ |
| `snr_stable_tolerance` | 3.0 dB | SNR ç¨³å®šå®¹å·® |
| `snr_stable_count_required` | 3 | è¿ç»­ç¨³å®šæ¬¡æ•° |

### 4.2 å¢ç›Šæ§åˆ¶å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `leader_gain` | 0.8 | Leader TX/RX å¢ç›Š |
| `follower_init_gain` | 0.7 | Follower åˆå§‹ TX å¢ç›Š |
| `min_gain` | 0.1 | æœ€å°å…è®¸å¢ç›Š |
| `max_gain` | 1.0 | æœ€å¤§å…è®¸å¢ç›Š |
| `gain_step` | 0.02 | åŸºç¡€è°ƒæ•´æ­¥é•¿ |
| `snr_tolerance` | 2.0 dB | è§¦å‘è°ƒæ•´çš„ SNR å®¹å·® |

---

## 5. æ“ä½œæµç¨‹

### 5.1 å‡†å¤‡å·¥ä½œ

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /home/chuzhitairan/V2V-Raft-SDR

# 2. ç¡®ä¿ SDR è®¾å¤‡è¿æ¥æ­£å¸¸
# E200: æ£€æŸ¥ç½‘ç»œè¿æ¥
ping 192.168.1.10
ping 192.168.1.11
ping 192.168.1.12
ping 192.168.1.13

# U200: æ£€æŸ¥ USB è¿æ¥
uhd_find_devices

# 3. ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™
chmod +x scripts/run_snr_experiment*.sh
```

### 5.2 è¿è¡Œ 3 èŠ‚ç‚¹æµ‹è¯• (è°ƒè¯•ç”¨)

ç”¨äºå¿«é€ŸéªŒè¯ç³»ç»Ÿæ˜¯å¦æ­£å¸¸å·¥ä½œï¼š

```bash
cd /home/chuzhitairan/V2V-Raft-SDR/scripts

# æ–¹å¼ 1: ä½¿ç”¨é»˜è®¤å‚æ•° (è°ƒè¯•æ¨¡å¼ï¼Œæ— é™ç­‰å¾…)
./run_snr_experiment_3node.sh

# æ–¹å¼ 2: è‡ªå®šä¹‰å‚æ•°
./run_snr_experiment_3node.sh <LEADER_GAIN> <FOLLOWER_GAIN> <START_SNR> <STATUS_INTERVAL> <DEBUG_MODE>

# ç¤ºä¾‹: Leaderå¢ç›Š0.8, Followeråˆå§‹å¢ç›Š0.7, èµ·å§‹SNR 20dB, çŠ¶æ€é—´éš”2ç§’, è°ƒè¯•æ¨¡å¼å¼€å¯
./run_snr_experiment_3node.sh 0.8 0.7 20.0 2.0 1

# å…³é—­è°ƒè¯•æ¨¡å¼ (ä¼šæ­£å¸¸è¿è¡Œå®éªŒ)
./run_snr_experiment_3node.sh 0.8 0.7 20.0 2.0 0
```

**è°ƒè¯•æ¨¡å¼è¯´æ˜ï¼š**
- `DEBUG_MODE=1`: Leader ä¼šæ— é™ç­‰å¾… SNR ç¨³å®šï¼Œæ–¹ä¾¿è§‚å¯ŸèŠ‚ç‚¹è¿æ¥çŠ¶æ€
- `DEBUG_MODE=0`: æ­£å¸¸è¿è¡Œå®éªŒæµç¨‹

### 5.3 è¿è¡Œ 4 èŠ‚ç‚¹å®éªŒ (PC1 - E200)

```bash
cd /home/chuzhitairan/V2V-Raft-SDR/scripts

# ä½¿ç”¨é»˜è®¤å‚æ•°
./run_snr_experiment.sh

# è‡ªå®šä¹‰å‚æ•°
./run_snr_experiment.sh <LEADER_GAIN> <FOLLOWER_GAIN> <START_SNR> <STATUS_INTERVAL>

# ç¤ºä¾‹
./run_snr_experiment.sh 0.8 0.7 20.0 2.0
```

### 5.4 åœæ­¢å®éªŒ

```bash
# æ–¹å¼ 1: åœ¨ç»ˆç«¯æŒ‰ Ctrl+C

# æ–¹å¼ 2: æ‰‹åŠ¨æ¸…ç†è¿›ç¨‹
pkill -f "v2v_hw_phy.py"
pkill -f "raft_leader_snr_experiment.py"
pkill -f "raft_follower_snr_experiment.py"
```

---

## 6. å®éªŒæµç¨‹è¯¦è§£

### 6.1 å¯åŠ¨é˜¶æ®µ

```
1. æ¸…ç†æ—§è¿›ç¨‹
   â†“
2. å¯åŠ¨ PHY å±‚ (æ¯ä¸ªèŠ‚ç‚¹ä¸€ä¸ª v2v_hw_phy.py)
   â†“
3. ç­‰å¾… PHY å°±ç»ª (check_phy_ready via ping)
   â†“
4. å¯åŠ¨åº”ç”¨å±‚ (Leader + Followers)
   â†“
5. Leader å¼€å§‹å‘é€å¿ƒè·³å’Œ SNR æŠ¥å‘Š
```

### 6.2 å®éªŒé˜¶æ®µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å®éªŒä¸»å¾ªç¯                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  for target_snr in [20, 18, 16, 14, ...]:                      â”‚
â”‚      â”‚                                                          â”‚
â”‚      â”œâ”€1. è®¾ç½®æ–°çš„ target_snr                                   â”‚
â”‚      â”‚   â””â”€ Follower æ”¶åˆ°åè°ƒæ•´ TX å¢ç›Š                         â”‚
â”‚      â”‚                                                          â”‚
â”‚      â”œâ”€2. ç­‰å¾… SNR ç¨³å®š                                         â”‚
â”‚      â”‚   â””â”€ è¿ç»­ 3 æ¬¡æ£€æµ‹ SNR åœ¨ targetÂ±3dB èŒƒå›´å†…              â”‚
â”‚      â”‚                                                          â”‚
â”‚      â”œâ”€3. æµ‹é‡é›†ç¾¤è§„æ¨¡ (100 æ¬¡)                                 â”‚
â”‚      â”‚   â””â”€ ç»Ÿè®¡ cluster_timeout å†…æœ‰å“åº”çš„èŠ‚ç‚¹æ•°               â”‚
â”‚      â”‚                                                          â”‚
â”‚      â”œâ”€4. è®°å½•ç»“æœ (avg, std, raw)                              â”‚
â”‚      â”‚                                                          â”‚
â”‚      â””â”€5. æ£€æŸ¥åœæ­¢æ¡ä»¶                                          â”‚
â”‚          â””â”€ if avg_cluster_size <= 1: åœæ­¢                      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 ç»“æœè¾“å‡º

å®éªŒç»“æŸåï¼Œç»“æœä¿å­˜åˆ° JSON æ–‡ä»¶ï¼š

```json
{
  "start_time": "2026-01-22T14:30:00",
  "total_nodes": 6,
  "start_snr": 20.0,
  "snr_step": 2.0,
  "measurements_per_snr": 100,
  "results": [
    {
      "target_snr": 20.0,
      "average_cluster_size": 4.0,
      "std_cluster_size": 0.0,
      "average_packet_loss": 0.02,
      "packet_loss_per_node": {"2": 0.01, "3": 0.02, "4": 0.03},
      "raw_cluster_measurements": [4, 4, 4, ...]
    },
    {
      "target_snr": 18.0,
      "average_cluster_size": 3.95,
      "std_cluster_size": 0.22,
      "average_packet_loss": 0.08,
      "packet_loss_per_node": {"2": 0.05, "3": 0.10, "4": 0.09},
      "raw_cluster_measurements": [4, 4, 4, 3, ...]
    },
    ...
  ]
}
```

**è¾“å‡ºå­—æ®µè¯´æ˜ï¼š**

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `target_snr` | ç›®æ ‡ SNR (dB) |
| `average_cluster_size` | å¹³å‡é›†ç¾¤è§„æ¨¡ |
| `std_cluster_size` | é›†ç¾¤è§„æ¨¡æ ‡å‡†å·® |
| `average_packet_loss` | å¹³å‡ä¸¢åŒ…ç‡ (0.0-1.0) |
| `packet_loss_per_node` | å„èŠ‚ç‚¹ä¸¢åŒ…ç‡ |
| `raw_cluster_measurements` | åŸå§‹æµ‹é‡æ•°æ® |

---

## 7. è§‚å¯ŸæŒ‡æ ‡

### 7.1 Leader çª—å£æ˜¾ç¤º

```
ğŸ“Š [Leader SNR è§‚æµ‹] ç›®æ ‡: 18.0 dB
   Node 2:  17.5 dB (-0.5) âœ…
   Node 3:  18.2 dB (+0.2) âœ…
   Node 4:  16.8 dB (-1.2) âœ…
   å¿ƒè·³: 1250, SNRæŠ¥å‘Š: 312

   âœ… SNR=18.0dB ç»“æœ:
      å¹³å‡é›†ç¾¤è§„æ¨¡: 4.00 Â± 0.00
      æœ€å°: 4, æœ€å¤§: 4
      å¹³å‡ä¸¢åŒ…ç‡: 2.5%
         Node 2: 1.8%
         Node 3: 2.9%
         Node 4: 2.8%
```

### 7.2 Follower çª—å£æ˜¾ç¤º

```
ğŸ“Š [Follower çŠ¶æ€] Node 2
   Leader è§‚æµ‹æˆ‘çš„ SNR: 17.5 dB (ç›®æ ‡ 18.0 dB) âœ… æ­£å¸¸
   å½“å‰ TX å¢ç›Š: 0.652
   æ—¥å¿—: 0, æäº¤: 0
   å¿ƒè·³: 625, SNRæŠ¥å‘Š: 156, å¢ç›Šè°ƒæ•´: 12
```

### 7.3 ç­‰å¾…ç¨³å®šé˜¶æ®µ

```
   â³ ç­‰å¾… SNR ç¨³å®š (ç›®æ ‡: 18.0Â±3.0 dB)...
      [1] â€¦ ç­‰å¾…: æ´»è·ƒ3ä¸ª [N2:15.3âœ“, N3:14.8âœ“, N4:16.2âœ“]
      [2] âœ“ ç¨³å®š 1/3: æ´»è·ƒ3ä¸ª [N2:17.8âœ“, N3:18.1âœ“, N4:17.5âœ“]
      [3] âœ“ ç¨³å®š 2/3: æ´»è·ƒ3ä¸ª [N2:18.0âœ“, N3:18.2âœ“, N4:17.9âœ“]
      [4] âœ“ ç¨³å®š 3/3: æ´»è·ƒ3ä¸ª [N2:18.1âœ“, N3:17.9âœ“, N4:18.0âœ“]
   âœ… SNR å·²ç¨³å®šï¼æ´»è·ƒèŠ‚ç‚¹: 3 ä¸ª
```

---

## 8. æ•…éšœæ’é™¤

### 8.1 PHY å¯åŠ¨è¶…æ—¶

```
âŒ Node X PHY å¯åŠ¨è¶…æ—¶
```

**è§£å†³æ–¹æ³•ï¼š**
1. æ£€æŸ¥ SDR è®¾å¤‡è¿æ¥
2. æ£€æŸ¥ IP åœ°å€/åºåˆ—å·é…ç½®
3. é‡å¯ SDR è®¾å¤‡

### 8.2 æ— æ´»è·ƒèŠ‚ç‚¹

```
âŒ æ— æ´»è·ƒèŠ‚ç‚¹ | å·²çŸ¥: []
```

**å¯èƒ½åŸå› ï¼š**
1. Follower æœªæ­£å¸¸å¯åŠ¨
2. PHY å±‚é€šä¿¡é—®é¢˜
3. ç«¯å£é…ç½®é”™è¯¯

**æ’æŸ¥æ–¹æ³•ï¼š**
```bash
# æ£€æŸ¥è¿›ç¨‹æ˜¯å¦è¿è¡Œ
ps aux | grep v2v_hw_phy
ps aux | grep raft_

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ulnp | grep 1000
netstat -ulnp | grep 2000
```

### 8.3 SNR ä¸€ç›´ä¸ç¨³å®š

```
      [10] âœ— ä¸ç¨³å®šï¼Œé‡ç½®: æ´»è·ƒ3ä¸ª [N2:12.3âœ“, N3:25.1âœ“, N4:8.7âœ“]
```

**å¯èƒ½åŸå› ï¼š**
1. å¢ç›Šè°ƒæ•´å‚æ•°ä¸åˆé€‚
2. æ— çº¿ç¯å¢ƒå¹²æ‰°ä¸¥é‡
3. ç›®æ ‡ SNR è®¾ç½®ä¸åˆç†

**è§£å†³æ–¹æ³•ï¼š**
1. å¢å¤§ `snr_tolerance`
2. å‡å° `gain_step`
3. è°ƒæ•´åˆå§‹å¢ç›Š

---

## 9. æ‰©å±•å®éªŒ

### 9.1 ä¸åŒå‚æ•°å¯¹æ¯”

```bash
# å®éªŒ 1: å¿«é€Ÿé€’å‡
./run_snr_experiment.sh 0.8 0.7 20.0 2.0  # step=2dB

# å®éªŒ 2: ç²¾ç»†é€’å‡ (ä¿®æ”¹è„šæœ¬)
# --snr-step 1.0

# å®éªŒ 3: æ›´å¤šæµ‹é‡
# --measurements 200
```

### 9.2 6 èŠ‚ç‚¹å®Œæ•´å®éªŒ

éœ€è¦åŒæ—¶åœ¨ PC1 å’Œ PC2 è¿è¡Œï¼š

```bash
# PC1 (4x E200)
./run_snr_experiment.sh

# PC2 (2x U200) - éœ€è¦åˆ›å»ºå¯¹åº”è„šæœ¬
./run_snr_experiment_pc2.sh
```

---

## 10. ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| [run_snr_experiment_3node.sh](../scripts/run_snr_experiment_3node.sh) | 3èŠ‚ç‚¹æµ‹è¯•è„šæœ¬ |
| [run_snr_experiment.sh](../scripts/run_snr_experiment.sh) | 4èŠ‚ç‚¹å®éªŒè„šæœ¬ |
| [raft_leader_snr_experiment.py](../scripts/app/raft_leader_snr_experiment.py) | Leader å®éªŒä»£ç  |
| [raft_follower_snr_experiment.py](../scripts/app/raft_follower_snr_experiment.py) | Follower å®éªŒä»£ç  |
| [v2v_hw_phy.py](../scripts/core/v2v_hw_phy.py) | PHY å±‚ä»£ç  |

---

*æ–‡æ¡£ç‰ˆæœ¬: 1.0*  
*æœ€åæ›´æ–°: 2026-01-22*
